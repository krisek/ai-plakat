<!DOCTYPE html>
<html lang="hu">
<head>
  <meta charset="UTF-8">
  <title>Bejegyzés szerkesztése</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
        rel="stylesheet">
  <!-- EasyMDE CSS (Markdown editor) -->
  <link href="https://cdn.jsdelivr.net/npm/easymde/dist/easymde.min.css"
        rel="stylesheet">
</head>
<body class="p-4">

  <h2 class="mb-4">Bejegyzés szerkesztése</h2>

  <!-- ------------------------------------------------ -->
  <!-- Two‑column layout: image preview | form -->
  <!-- ------------------------------------------------ -->
  <div class="row g-4"><!-- g-4 = gap between columns -->

    <!-- ---------- LEFT COLUMN – image preview ---------- -->
    <div class="col-md-6 d-flex justify-content-center align-items-start">
      {% if preview_image_url %}
        <img src="{{ preview_image_url }}" alt="Uploaded preview"
             style="max-width: 100%; max-height: 800px; object-fit: contain;">
      {% else %}
        <p class="text-muted">Nincs előnézeti kép.</p>
      {% endif %}
    </div>

    <!-- ---------- RIGHT COLUMN – the form ---------- -->
    <div class="col-md-6">
      <form action="/finalize" method="post" enctype="multipart/form-data">
        <!-- hidden fields keep the uploaded file on the server -->
        <input type="hidden" name="temp_path" value="{{ temp_path }}">

        <div class="mb-3">
          <label class="form-label">Dátum és idő</label>
          <input type="datetime-local" class="form-control"
                 name="datetime_str" value="{{ datetime_str }}" required>
        </div>

        <div class="mb-3">
          <label class="form-label">Cím</label>
          <input type="text" class="form-control" name="title"
                 value="{{ title|default('') }}" required>
        </div>

        <!-- ---------- SUMMARY (Markdown) ---------- -->
        <div class="mb-3">
          <label class="form-label">Összefoglaló (Markdown)</label>
          <textarea class="form-control" id="summary" name="summary"
                    rows="4" required>{{ summary|default('') }}</textarea>
        </div>

        <!-- ---------- CONTENT (Markdown) ---------- -->
        <div class="mb-3">
          <label class="form-label">Tartalom (Markdown)</label>
          <textarea class="form-control" id="content" name="content"
                    rows="10" required>{{ content|default('') }}</textarea>
        </div>

        <button type="submit" class="btn btn-success">Mentés</button>
      </form>
    </div>

  </div><!-- /.row -->

  <!-- ------------------------------------------------ -->
  <!-- JS dependencies (Bootstrap optional)            -->
  <!-- ------------------------------------------------ -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  <!-- EasyMDE JS -->
  <script src="https://cdn.jsdelivr.net/npm/easymde/dist/easymde.min.js"></script>

  <script>
    // Initialise EasyMDE for the two markdown fields
    const summaryEditor = new EasyMDE({
      element: document.getElementById('summary'),
      spellChecker: false,
      maxHeight: "90px",
      placeholder: "Írj egy rövid összefoglalót Markdown‑formátumban..."
    });

    const contentEditor = new EasyMDE({
      element: document.getElementById('content'),
      spellChecker: false,
      maxHeight: "180px",
      placeholder: "Írj részletes tartalmat Markdown‑formátumban..."
    });
  </script>
</body>
</html>